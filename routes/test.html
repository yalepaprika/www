<svelte:head>
  <title>3D</title>
</svelte:head>

<div class="x c12 xjc xac">
  <canvas ref:canvas></canvas>
</div>

<style>
  canvas {
    width: 50vw;
    height: 50vh;
  }
</style>

<script>
  import reglWrapper from 'regl'

  export default {
    oncreate() {
      let regl = reglWrapper(this.refs.canvas)
      this.refs.canvas.width = this.refs.canvas.clientWidth;
      this.refs.canvas.height = this.refs.canvas.clientHeight;
      regl.clear({
        color: [0, 0, 0, 1],
        depth: 1
      })

      // In regl, draw operations are specified declaratively using. Each JSON
      // command is a complete description of all state. This removes the need to
      // .bind() things like buffers or shaders. All the boilerplate of setting up
      // and tearing down state is automated.
      regl({

        // In a draw call, we can pass the shader source code to regl
        frag: `
        precision mediump float;
        uniform vec4 color;
        void main () {
          gl_FragColor = color;
        }`,

        vert: `
        precision mediump float;
        attribute vec2 position;
        void main () {
          gl_Position = vec4(position, 0, 1);
        }`,

        attributes: {
          position: [
            [-1, 0],
            [0, -1],
            [1, 1]
          ]
        },

        uniforms: {
          color: [1, 0, 0, 1]
        },

        count: 3
      })()
    }
  }
</script>